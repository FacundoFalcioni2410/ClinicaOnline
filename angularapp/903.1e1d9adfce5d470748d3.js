"use strict";(self.webpackChunkclinica_online=self.webpackChunkclinica_online||[]).push([[903],{1903:(Ce,A,d)=>{d.r(A),d.d(A,{TurnosModule:()=>be});var m=d(8583),v=d(611),e=d(7716);let q=(()=>{class o{constructor(i){this.router=i,this.usuario=JSON.parse(localStorage.getItem("usuario"))}canActivate(i,t){var n,a;return"paciente"===(null===(n=this.usuario)||void 0===n?void 0:n.perfil)||"admin"===(null===(a=this.usuario)||void 0===a?void 0:a.perfil)||(this.router.navigate(["/sin-permisos"]),!1)}}return o.\u0275fac=function(i){return new(i||o)(e.LFG(v.F0))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var E=d(1896);let y=(()=>{class o{constructor(i){this.router=i,this.usuario=JSON.parse(localStorage.getItem("usuario"))}canActivate(i,t){var n;return"especialista"===(null===(n=this.usuario)||void 0===n?void 0:n.perfil)||(this.router.navigate(["/sin-permisos"]),!1)}}return o.\u0275fac=function(i){return new(i||o)(e.LFG(v.F0))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),M=(()=>{class o{constructor(i){this.router=i,this.usuario=JSON.parse(localStorage.getItem("usuario"))}canActivate(i,t){var n;return"paciente"===(null===(n=this.usuario)||void 0===n?void 0:n.perfil)||(this.router.navigate(["/sin-permisos"]),!1)}}return o.\u0275fac=function(i){return new(i||o)(e.LFG(v.F0))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var f=d(8239),k=d(8259),p=d.n(k),Z=d(5160),g=d(665),T=d(4132);function F(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"span",43),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw(2).seleccionarPaciente(a)}),e._UZ(1,"img",44),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(1),e.Q6J("src",null==i?null:i.imagenes[0],e.LSH)}}function U(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"span",45),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw(2).seleccionarEspecialidad(a)}),e._UZ(1,"img",44),e.TgZ(2,"p"),e._uU(3),e.qZA(),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(1),e.Q6J("src",null==i?null:i.imagen,e.LSH),e.xp6(2),e.Oqu(i.especialidad)}}function O(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"i",56),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw(2).cancelarTurno(n)}),e.qZA()}}function I(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"i",57),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw(2).rechazarTurno(n)}),e.qZA()}}function w(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"i",58),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw(2).aceptarTurno(n)}),e.qZA()}}function J(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"i",59),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw(2).turnoActual=n}),e.qZA()}}function N(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"i",60),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw(2).verComentario(n)}),e.qZA()}}function z(o,s){if(1&o&&(e.TgZ(0,"div",46),e.TgZ(1,"div",47),e.TgZ(2,"h6"),e._uU(3),e.qZA(),e.TgZ(4,"h6"),e._uU(5),e.qZA(),e.TgZ(6,"h6"),e._uU(7),e.qZA(),e.TgZ(8,"h6",48),e._uU(9),e.qZA(),e.TgZ(10,"h6",48),e._uU(11),e.qZA(),e.TgZ(12,"h6"),e._uU(13),e.ALo(14,"uppercase"),e.qZA(),e.qZA(),e.TgZ(15,"div",49),e.TgZ(16,"div",50),e.YNc(17,O,1,0,"i",51),e.YNc(18,I,1,0,"i",52),e.YNc(19,w,1,0,"i",53),e.YNc(20,J,1,0,"i",54),e.YNc(21,N,1,0,"i",55),e.qZA(),e.qZA(),e.qZA()),2&o){const i=s.$implicit,t=e.oxw(2);e.xp6(3),e.Oqu(i.fecha),e.xp6(2),e.Oqu(i.hora),e.xp6(2),e.Oqu(i.especialidad),e.xp6(2),e.lnq("",null==i.pacienteCompleto?null:i.pacienteCompleto.nombre," ",null==i.pacienteCompleto?null:i.pacienteCompleto.apellido," - ",null==i.pacienteCompleto?null:i.pacienteCompleto.dni,""),e.xp6(2),e.lnq("",null==t.especialista?null:t.especialista.nombre," ",null==t.especialista?null:t.especialista.apellido," - ",null==t.especialista?null:t.especialista.dni,""),e.xp6(2),e.Oqu(e.lcZ(14,15,i.estado)),e.xp6(4),e.Q6J("ngIf","aceptado"!==i.estado&&"cancelado"!==i.estado&&"rechazado"!==i.estado&&"realizado"!==i.estado),e.xp6(1),e.Q6J("ngIf","aceptado"!==i.estado&&"realizado"!==i.estado&&"rechazado"!==i.estado&&"cancelado"!==i.estado),e.xp6(1),e.Q6J("ngIf","realizado"!==i.estado&&"cancelado"!==i.estado&&"rechazado"!==i.estado&&"aceptado"!==i.estado),e.xp6(1),e.Q6J("ngIf","aceptado"===i.estado),e.xp6(1),e.Q6J("ngIf",(null==i?null:i.atencion)||(null==i?null:i.razon)||(null==i?null:i.satisfaccion))}}function P(o,s){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"span",61),e._uU(2),e.qZA(),e.qZA()),2&o){const i=e.oxw(2);e.xp6(2),e.Oqu(i.mensaje)}}function S(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"h2",34),e._uU(2,"Listado de mis turnos"),e.qZA(),e.TgZ(3,"i",35),e.NdJ("click",function(){return e.CHM(i),e.oxw().limpiarFiltros()}),e._uU(4,"Limpiar filtros"),e.qZA(),e.TgZ(5,"div",36),e.YNc(6,F,2,1,"span",37),e.qZA(),e.TgZ(7,"div",38),e.YNc(8,U,4,2,"span",39),e.qZA(),e.TgZ(9,"div",40),e.YNc(10,z,22,17,"div",41),e.qZA(),e.YNc(11,P,3,1,"div",42),e.qZA()}if(2&o){const i=e.oxw();e.xp6(6),e.Q6J("ngForOf",i.pacientes),e.xp6(2),e.Q6J("ngForOf",i.array),e.xp6(2),e.Q6J("ngForOf",i.turnosMostrar),e.xp6(1),e.Q6J("ngIf",""!==i.mensaje)}}function Y(o,s){1&o&&e._UZ(0,"app-spinner")}let D=(()=>{class o{constructor(i){var t=this;this.firestore=i,this.turnos=[],this.turnosMostrar=[],this.pacientes=[],this.especialidades=[],this.array=[],this.mensaje="",this.especialista=JSON.parse(localStorage.getItem("usuario")),this.firestore.especialidadesObs.subscribe(n=>{this.firestore.turnosObs.subscribe(function(){var a=(0,f.Z)(function*(l){var r;t.especialidades=n,t.turnos=[];let u=0;for(let c of l)if(c.especialista===(null===(r=null==t?void 0:t.especialista)||void 0===r?void 0:r.dni)){t.turnos.push(c);for(let _ of t.especialista.especialidad)for(let h of t.especialidades)_===h.especialidad&&(u=t.array.indexOf(h),-1===u&&t.array.push(h))}yield t.getPacientes(),t.turnosMostrar=t.turnos});return function(l){return a.apply(this,arguments)}}())})}ngOnInit(){}limpiarFiltros(){this.mensaje="",this.turnosMostrar=this.turnos}getPacientes(){var i=this;return(0,f.Z)(function*(){let n;for(let a of i.turnos)n=yield i.firestore.getPaciente(a.paciente),a.pacienteCompleto=n,i.pacientes.push(n);i.pacientes=i.eliminarObjetosDuplicados(i.pacientes,"dni")})()}eliminarObjetosDuplicados(i,t){var n=[],a={};for(let l in i)a[i[l][t]]=i[l];for(let l in a)n.push(a[l]);return n}seleccionarPaciente(i){this.turnosMostrar=[],this.paciente=i;for(let t of this.turnos)t.paciente===i.dni&&this.turnosMostrar.push(t);0===this.turnosMostrar.length&&(this.mensaje="No hay turnos con el paciente seleccionado")}seleccionarEspecialidad(i){this.mensaje="",this.turnosMostrar=[],this.especialidad=i.especialidad;for(let t of this.turnos)t.especialidad===this.especialidad&&this.turnosMostrar.push(t);0===this.turnosMostrar.length&&(this.mensaje="No hay turnos con la especialidad seleccionada")}aceptarTurno(i){i.estado="aceptado",this.firestore.modificarEstadoTurno(i)}rechazarTurno(i){var t=this;return(0,f.Z)(function*(){const{value:n}=yield p().fire({title:"Finalizar turno",input:"text",inputLabel:"Ingrese un la razon por la que rechaza el turno: ",inputAttributes:{autocomplete:"off"}});n&&(i.estado="rechazado",i.razon=n,t.firestore.modificarEstadoTurno(i))})()}cancelarTurno(i){var t=this;return(0,f.Z)(function*(){let n=0;const{value:a}=yield p().fire({title:"Finalizar turno",input:"text",inputLabel:"Ingrese la razon por la que cancela el turno: ",inputAttributes:{autocomplete:"off"}});if(a){i.estado="cancelado",i.razon=a,t.firestore.modificarEstadoTurno(i);for(let[l,r]of i.pacienteCompleto.turno.entries())if(i.fecha===r.fecha&&i.hora===r.hora){n=l;break}i.pacienteCompleto.turno.splice(n,1),t.firestore.finalizarTurnoPaciente(i.pacienteCompleto);for(let[l,r]of t.especialista.turno.entries())if(i.fecha===r.fecha&&i.hora===r.hora){n=l;break}t.especialista.turno.splice(n,1),t.firestore.finalizarTurnoEspecialista(t.especialista)}})()}finalizarTurno(){var i=this;return(0,f.Z)(function*(){let t=0,n=document.getElementById("altura").value,a=document.getElementById("peso").value,l=document.getElementById("temperatura").value,r=document.getElementById("presion").value,u={clave:document.getElementById("dinamicoClave1").value,valor:document.getElementById("dinamicoValor1").value},c={clave:document.getElementById("dinamicoClave2").value,valor:document.getElementById("dinamicoValor2").value},_={clave:document.getElementById("dinamicoClave3").value,valor:document.getElementById("dinamicoValor3").value},h={clave:document.getElementById("dinamicoClave4").value,valor:document.getElementById("dinamicoValor4").value};if(n&&a&&r&&l&&u.clave&&u.valor&&c.valor&&c.clave&&_.valor&&_.clave&&h.valor&&h.clave){const{value:C}=yield p().fire({title:"Finalizar turno",input:"text",inputLabel:"Ingrese un comentario sobre el turno: ",inputAttributes:{autocomplete:"off"}});if(i.turnoActual.pacienteCompleto.historiaClinica={altura:n,peso:a,presion:r,temperatura:l,dinamico1:u,dinamico2:c,dinamico3:_,dinamico4:h},C&&i.turnoActual.pacienteCompleto.historiaClinica){i.firestore.addHistoriaClinica(i.turnoActual.pacienteCompleto),i.turnoActual.estado="realizado",i.turnoActual.comentario=C,i.firestore.modificarEstadoTurno(i.turnoActual);for(let[b,x]of i.turnoActual.pacienteCompleto.turno.entries())if(i.turnoActual.fecha===x.fecha&&i.turnoActual.hora===x.hora){t=b;break}i.turnoActual.pacienteCompleto.turno.splice(t,1),i.firestore.finalizarTurnoPaciente(i.turnoActual.pacienteCompleto);for(let[b,x]of i.especialista.turno.entries())if(i.turnoActual.fecha===x.fecha&&i.turnoActual.hora===x.hora){t=b;break}i.especialista.turno.splice(t,1),i.firestore.finalizarTurnoEspecialista(i.especialista)}}else p().fire({title:"Error",text:"Asegurese de completar todos los campos",toast:!0,timer:1500,icon:"error",timerProgressBar:!0,position:"bottom"})})()}verComentario(i){(null==i?void 0:i.satisfaccion)?p().fire({title:"Comentario sobre el turno",text:`Satisfaccion del paciente: ${i.satisfaccion}, comentario del paciente: ${i.atencion}`}):(null==i?void 0:i.razon)&&p().fire({title:"Motivo de cancelacion/rechazo del turno",text:i.razon})}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(Z.C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-mis-turnos-especialista"]],decls:57,vars:2,consts:[[1,"container"],[4,"ngIf","ngIfElse"],["spinner",""],["id","modal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"mb-3"],["for","altura",1,"col-form-label"],["type","number","id","altura",1,"form-control"],["for","peso",1,"col-form-label"],["type","number","id","peso",1,"form-control"],["for","temperatura",1,"col-form-label"],["type","number","id","temperatura",1,"form-control"],["for","presion",1,"col-form-label"],["type","number","id","presion",1,"form-control"],["for","dinamico1Clave",1,"col-form-label"],["type","text","id","dinamicoClave1",1,"form-control","mb-2"],["type","text","id","dinamicoValor1",1,"form-control"],["for","dinamico2Clave",1,"col-form-label"],["type","text","id","dinamicoClave2",1,"form-control","mb-2"],["type","text","id","dinamicoValor2",1,"form-control"],["for","dinamico3Clave",1,"col-form-label"],["type","text","id","dinamicoClave3",1,"form-control","mb-2"],["type","text","id","dinamicoValor3",1,"form-control"],["for","dinamico4Clave",1,"col-form-label"],["type","text","id","dinamicoClave4",1,"form-control","mb-2"],["type","text","id","dinamicoValor4",1,"form-control"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click"],[1,"text-center","text-light"],[1,"bi","bi-funnel-fill","text-info","noselect",3,"click"],[1,"col-12","col-sm-6"],["class","badge rounded-pill bg-dark text-light m-1 mt-2 p-2 noselect",3,"click",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","d-flex","text-light"],["class","d-inline-flex flex-column me-2",3,"click",4,"ngFor","ngForOf"],[1,"row","justify-content-around",2,"column-gap","40px","row-gap","15px"],["class","col-12 col-md-3 row rounded text-white","style","background-color: rgba(0,0,0,.5);",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"badge","rounded-pill","bg-dark","text-light","m-1","mt-2","p-2","noselect",3,"click"],["alt","","width","80px","height","80px",2,"border-radius","50%",3,"src"],[1,"d-inline-flex","flex-column","me-2",3,"click"],[1,"col-12","col-md-3","row","rounded","text-white",2,"background-color","rgba(0,0,0,.5)"],[1,"col-6"],[1,"text-break"],[1,"col-6","d-flex","h-100","justify-content-end"],[1,"d-flex","flex-column"],["class","bi bi-x-square-fill","title","Cancelar turno",3,"click",4,"ngIf"],["class","bi bi-x-lg ms-1","title","Rechazar turno",3,"click",4,"ngIf"],["class","bi bi-check-circle ms-1","title","Aceptar turno",3,"click",4,"ngIf"],["class","bi bi-check-square-fill ms-1","title","Finalizar turno","data-bs-toggle","modal","data-bs-target","#modal",3,"click",4,"ngIf"],["class","bi bi-layout-text-sidebar-reverse ms-1","title","Ver rese\xf1a",3,"click",4,"ngIf"],["title","Cancelar turno",1,"bi","bi-x-square-fill",3,"click"],["title","Rechazar turno",1,"bi","bi-x-lg","ms-1",3,"click"],["title","Aceptar turno",1,"bi","bi-check-circle","ms-1",3,"click"],["title","Finalizar turno","data-bs-toggle","modal","data-bs-target","#modal",1,"bi","bi-check-square-fill","ms-1",3,"click"],["title","Ver rese\xf1a",1,"bi","bi-layout-text-sidebar-reverse","ms-1",3,"click"],[1,"text-danger"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,S,12,4,"div",1),e.YNc(2,Y,1,0,"ng-template",null,2,e.W1O),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"h5",7),e._uU(9,"Carga de historia clinica"),e.qZA(),e._UZ(10,"button",8),e.qZA(),e.TgZ(11,"div",9),e.TgZ(12,"form"),e.TgZ(13,"div",10),e.TgZ(14,"label",11),e._uU(15,"Altura"),e.qZA(),e._UZ(16,"input",12),e.qZA(),e.TgZ(17,"div",10),e.TgZ(18,"label",13),e._uU(19,"Peso"),e.qZA(),e._UZ(20,"input",14),e.qZA(),e.TgZ(21,"div",10),e.TgZ(22,"label",15),e._uU(23,"temperatura"),e.qZA(),e._UZ(24,"input",16),e.qZA(),e.TgZ(25,"div",10),e.TgZ(26,"label",17),e._uU(27,"Presi\xf3n"),e.qZA(),e._UZ(28,"input",18),e.qZA(),e.TgZ(29,"div",10),e.TgZ(30,"label",11),e._uU(31,"A continuacion ingrese los datos que crea conveniente. Teniendo en cuenta que primero debe cargar que dato es, y luego la informacion sobre el mismo"),e.qZA(),e.qZA(),e.TgZ(32,"div",10),e.TgZ(33,"label",19),e._uU(34,"Dato 1"),e.qZA(),e._UZ(35,"input",20),e._UZ(36,"input",21),e.qZA(),e.TgZ(37,"div",10),e.TgZ(38,"label",22),e._uU(39,"Dato 2"),e.qZA(),e._UZ(40,"input",23),e._UZ(41,"input",24),e.qZA(),e.TgZ(42,"div",10),e.TgZ(43,"label",25),e._uU(44,"Dato 3"),e.qZA(),e._UZ(45,"input",26),e._UZ(46,"input",27),e.qZA(),e.TgZ(47,"div",10),e.TgZ(48,"label",28),e._uU(49,"Dato 4"),e.qZA(),e._UZ(50,"input",29),e._UZ(51,"input",30),e.qZA(),e.qZA(),e.qZA(),e.TgZ(52,"div",31),e.TgZ(53,"button",32),e._uU(54,"Close"),e.qZA(),e.TgZ(55,"button",33),e.NdJ("click",function(){return t.finalizarTurno()}),e._uU(56,"Enviar encuesta"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const n=e.MAs(3);e.xp6(1),e.Q6J("ngIf",t.turnosMostrar.length)("ngIfElse",n)}},directives:[m.O5,g._Y,g.JL,g.F,m.sg,T.O],pipes:[m.gd],styles:[""]}),o})();function Q(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"span",30),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw(2).seleccionarEspecialista(a)}),e._UZ(1,"img",31),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(1),e.Q6J("src",null==i?null:i.imagen,e.LSH)}}function j(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"span",32),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw(2).seleccionarEspecialidad(a)}),e._UZ(1,"img",31),e.TgZ(2,"p"),e._uU(3),e.qZA(),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(1),e.Q6J("src",null==i?null:i.imagen,e.LSH),e.xp6(2),e.Oqu(i.especialidad)}}function H(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"i",42),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw(2).cancelarTurno(n)}),e.qZA()}}function $(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"i",43),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw(2).verComentario(n)}),e.qZA()}}function L(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"i",44),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw(2).turnoEncuesta=n}),e.qZA()}}function B(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"i",45),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit;return e.oxw(2).turnoEncuesta=n}),e.qZA()}}function V(o,s){if(1&o&&(e.TgZ(0,"div",33),e.TgZ(1,"div",34),e.TgZ(2,"h6"),e._uU(3),e.qZA(),e.TgZ(4,"h6"),e._uU(5),e.qZA(),e.TgZ(6,"h6"),e._uU(7),e.qZA(),e.TgZ(8,"h6",35),e._uU(9),e.qZA(),e.TgZ(10,"h6",35),e._uU(11),e.qZA(),e.TgZ(12,"h6"),e._uU(13),e.ALo(14,"uppercase"),e.qZA(),e.qZA(),e.TgZ(15,"div",36),e.TgZ(16,"div",37),e.YNc(17,H,1,0,"i",38),e.YNc(18,$,1,0,"i",39),e.YNc(19,L,1,0,"i",40),e.YNc(20,B,1,0,"i",41),e.qZA(),e.qZA(),e.qZA()),2&o){const i=s.$implicit,t=e.oxw(2);e.xp6(3),e.Oqu(i.fecha),e.xp6(2),e.Oqu(i.hora),e.xp6(2),e.Oqu(i.especialidad),e.xp6(2),e.lnq("",null==i.especialistaCompleto?null:i.especialistaCompleto.nombre," ",null==i.especialistaCompleto?null:i.especialistaCompleto.apellido," - ",null==i.especialistaCompleto?null:i.especialistaCompleto.dni,""),e.xp6(2),e.lnq("",null==t.paciente?null:t.paciente.nombre," ",null==t.paciente?null:t.paciente.apellido," - ",null==t.paciente?null:t.paciente.dni,""),e.xp6(2),e.Oqu(e.lcZ(14,14,i.estado)),e.xp6(4),e.Q6J("ngIf","aceptado"!==i.estado&&"cancelado"!==i.estado&&"rechazado"!==i.estado&&"realizado"!==i.estado),e.xp6(1),e.Q6J("ngIf",(null==i?null:i.comentario)||(null==i?null:i.razon)),e.xp6(1),e.Q6J("ngIf","realizado"===i.estado&&(null==i?null:i.comentario)&&!i.encuesta),e.xp6(1),e.Q6J("ngIf","realizado"===i.estado&&!i.satisfaccion)}}function G(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"h2",22),e._uU(2,"Listado de mis turnos"),e.qZA(),e.TgZ(3,"i",23),e.NdJ("click",function(){return e.CHM(i),e.oxw().limpiarFiltros()}),e._uU(4,"Limpiar filtros"),e.qZA(),e.TgZ(5,"div",24),e.YNc(6,Q,2,1,"span",25),e.qZA(),e.TgZ(7,"div",26),e.YNc(8,j,4,2,"span",27),e.qZA(),e.TgZ(9,"div",28),e.YNc(10,V,21,16,"div",29),e.qZA(),e.qZA()}if(2&o){const i=e.oxw();e.xp6(6),e.Q6J("ngForOf",i.especialistas),e.xp6(2),e.Q6J("ngForOf",i.array),e.xp6(2),e.Q6J("ngForOf",i.turnosMostrar)}}function R(o,s){1&o&&e._UZ(0,"app-spinner")}let X=(()=>{class o{constructor(i){var t=this;this.firestore=i,this.turnos=[],this.turnosMostrar=[],this.pacientes=[],this.especialistas=[],this.especialidades=[],this.array=[],this.mensaje="",this.paciente=JSON.parse(localStorage.getItem("usuario")),this.firestore.especialidadesObs.subscribe(n=>{this.especialidades=n,this.firestore.turnosObs.subscribe(function(){var a=(0,f.Z)(function*(l){var r;t.turnos=[];let u=0;for(let c of l)if(c.paciente===(null===(r=null==t?void 0:t.paciente)||void 0===r?void 0:r.dni)){t.turnos.push(c);for(let _ of t.especialidades)c.especialidad===_.especialidad&&(u=t.array.indexOf(_),-1===u&&t.array.push(_))}yield t.getEspecialista(),t.turnosMostrar=t.turnos});return function(l){return a.apply(this,arguments)}}())})}ngOnInit(){}limpiarFiltros(){this.mensaje="",this.turnosMostrar=this.turnos}getEspecialista(){var i=this;return(0,f.Z)(function*(){let n;for(let a of i.turnos)n=yield i.firestore.getEspecialista(a.especialista),a.especialistaCompleto=n,i.especialistas.push(n);i.especialistas=i.eliminarObjetosDuplicados(i.especialistas,"dni")})()}eliminarObjetosDuplicados(i,t){var n=[],a={};for(let l in i)a[i[l][t]]=i[l];for(let l in a)n.push(a[l]);return n}seleccionarEspecialista(i){this.turnosMostrar=[],this.especialista=i;for(let t of this.turnos)t.especialista===i.dni&&this.turnosMostrar.push(t);0===this.turnosMostrar.length&&(this.mensaje="No hay turnos con el especialista seleccionado")}seleccionarEspecialidad(i){this.mensaje="",this.turnosMostrar=[],this.especialidad=i.especialidad;for(let t of this.turnos)t.especialidad===this.especialidad&&this.turnosMostrar.push(t);0===this.turnosMostrar.length&&(this.mensaje="No hay turnos con la especialidad seleccionada")}cancelarTurno(i){var t=this;return(0,f.Z)(function*(){const{value:n}=yield p().fire({title:"Cancelaci\xf3n de turno",input:"text",inputLabel:"Motivo de cancelaci\xf3n",inputValue:"",showCancelButton:!0,inputValidator:a=>a?"":"Debe especificar el motivo de la cancelaci\xf3n",inputAttributes:{required:"true",autocomplete:"off"}});n?(i.estado="cancelado",i.razon=n,t.firestore.modificarEstadoTurno(i)):p().fire({text:"El turno no ha podido ser cancelado. Motivo: Debe especificar una razon",timer:2500,timerProgressBar:!0,icon:"error",position:"bottom",toast:!0})})()}verComentario(i){(null==i?void 0:i.comentario)?p().fire({title:"Comentario sobre el turno",text:i.comentario}):(null==i?void 0:i.razon)&&p().fire({title:"Motivo de cancelacion/rechazo del turno",text:i.razon})}satisfaccion(){var i=this;return(0,f.Z)(function*(){console.log(i.turnoEncuesta);let n,t=document.getElementById("satisfaccion").value;document.getElementById("satisfaccion").value="",t&&(n=document.getElementById("atencion").value,document.getElementById("atencion").value="",i.turnoEncuesta.satisfaccion=t,n&&(i.turnoEncuesta.atencion=n,i.firestore.addSatisfaccionAtencion(i.turnoEncuesta)))})()}enviarEncuesta(){console.log(this.turnoEncuesta);let t,i=document.getElementById("tiempo").value;if(document.getElementById("tiempo").value="",i){t=document.getElementById("preguntas").checked;let a={tiempoEspera:i,consultas:t};this.firestore.addEncuesta({paciente:this.paciente.dni,especialidad:this.turnoEncuesta.especialidad,especialista:this.turnoEncuesta.especialista,datos:{tiempoEspera:i,consultas:t}}),this.firestore.addEncuestaTurno(this.turnoEncuesta,a)}}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(Z.C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-mis-turnos-paciente"]],decls:50,vars:2,consts:[[1,"container"],[4,"ngIf","ngIfElse"],["spinner",""],["id","modal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"mb-3"],["for","tiempo",1,"col-form-label"],["type","number","id","tiempo",1,"form-control"],["for","preguntas",1,"col-form-label"],["type","checkbox","value","","id","preguntas",1,"form-check-input"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click"],["id","modalSatisfaccion","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["type","range","min","1","max","10","step","1","id","satisfaccion",1,"form-range"],["for","atencion",1,"col-form-label"],["type","text","autocomplete","off","id","atencion",1,"form-control"],[1,"text-center"],[1,"bi","bi-funnel-fill","text-info","noselect",3,"click"],[1,"col-12","col-sm-6"],["class","badge rounded-pill bg-dark text-light m-1 mt-2 p-2 noselect",3,"click",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","d-flex","text-light"],["class","d-inline-flex flex-column me-2",3,"click",4,"ngFor","ngForOf"],[1,"row","justify-content-around",2,"column-gap","40px","row-gap","15px"],["class","col-12 col-md-3 row rounded text-white","style","background-color: rgba(0,0,0,.5);",4,"ngFor","ngForOf"],[1,"badge","rounded-pill","bg-dark","text-light","m-1","mt-2","p-2","noselect",3,"click"],["alt","","width","80px","height","80px",2,"border-radius","50%",3,"src"],[1,"d-inline-flex","flex-column","me-2",3,"click"],[1,"col-12","col-md-3","row","rounded","text-white",2,"background-color","rgba(0,0,0,.5)"],[1,"col-6"],[1,"text-break"],[1,"col-6","d-flex","h-100","justify-content-end"],[1,"d-flex","flex-column"],["class","bi bi-x-square-fill","title","Cancelar turno",3,"click",4,"ngIf"],["class","bi bi-layout-text-sidebar-reverse ms-1","title","Ver rese\xf1a",3,"click",4,"ngIf"],["class","bi bi-ui-checks ms-2","data-bs-toggle","modal","data-bs-target","#modal",3,"click",4,"ngIf"],["class","bi bi-emoji-smile ms-2","title","Calificar atenci\xf3n","data-bs-toggle","modal","data-bs-target","#modalSatisfaccion",3,"click",4,"ngIf"],["title","Cancelar turno",1,"bi","bi-x-square-fill",3,"click"],["title","Ver rese\xf1a",1,"bi","bi-layout-text-sidebar-reverse","ms-1",3,"click"],["data-bs-toggle","modal","data-bs-target","#modal",1,"bi","bi-ui-checks","ms-2",3,"click"],["title","Calificar atenci\xf3n","data-bs-toggle","modal","data-bs-target","#modalSatisfaccion",1,"bi","bi-emoji-smile","ms-2",3,"click"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,G,11,3,"div",1),e.YNc(2,R,1,0,"ng-template",null,2,e.W1O),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"h5",7),e._uU(9,"Encuesta de atenci\xf3n"),e.qZA(),e._UZ(10,"button",8),e.qZA(),e.TgZ(11,"div",9),e.TgZ(12,"form"),e.TgZ(13,"div",10),e.TgZ(14,"label",11),e._uU(15,"Desde su llegada a la clinica hasta que le atendi\xf3 el m\xe9dico, \xbfcu\xe1nto tiempo pas\xf3? "),e._UZ(16,"br"),e._uU(17," Nota: Ingrese el tiempo en minutos"),e.qZA(),e._UZ(18,"input",12),e.qZA(),e.TgZ(19,"div",10),e.TgZ(20,"label",13),e._uU(21," Mientras estuvo en la consulta, \xbfpudo comentar al m\xe9dico todas las cosas que le preocupaban por su salud? "),e.qZA(),e._UZ(22,"input",14),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"div",15),e.TgZ(24,"button",16),e._uU(25,"Close"),e.qZA(),e.TgZ(26,"button",17),e.NdJ("click",function(){return t.enviarEncuesta()}),e._uU(27,"Enviar encuesta"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"div",18),e.TgZ(29,"div",4),e.TgZ(30,"div",5),e.TgZ(31,"div",6),e.TgZ(32,"h5",7),e._uU(33,"Encuesta de atenci\xf3n"),e.qZA(),e._UZ(34,"button",8),e.qZA(),e.TgZ(35,"div",9),e.TgZ(36,"form"),e.TgZ(37,"div",10),e.TgZ(38,"label",11),e._uU(39,"Satisfaccion con el turno"),e.qZA(),e._UZ(40,"input",19),e.qZA(),e.TgZ(41,"div",10),e.TgZ(42,"label",20),e._uU(43," Atencion del especialista "),e.qZA(),e._UZ(44,"input",21),e.qZA(),e.qZA(),e.qZA(),e.TgZ(45,"div",15),e.TgZ(46,"button",16),e._uU(47,"Close"),e.qZA(),e.TgZ(48,"button",17),e.NdJ("click",function(){return t.satisfaccion()}),e._uU(49,"Enviar comentario"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const n=e.MAs(3);e.xp6(1),e.Q6J("ngIf",t.turnosMostrar.length)("ngIfElse",n)}},directives:[m.O5,g._Y,g.JL,g.F,m.sg,T.O],pipes:[m.gd],styles:[""]}),o})();var W=d(7989);function K(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"app-tabla-paciente",12),e.NdJ("enviar",function(n){return e.CHM(i),e.oxw(2).recibirPaciente(n)}),e.qZA()}if(2&o){const i=e.oxw(2);e.Q6J("pacientes",i.pacientes)}}function ee(o,s){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,K,1,1,"app-tabla-paciente",11),e.qZA()),2&o){const i=e.oxw(),t=e.MAs(15);e.xp6(1),e.Q6J("ngIf",void 0!==i.pacientes)("ngIfElse",t)}}function ie(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"span",13),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw().cambiarEspecialista(a)}),e._UZ(1,"img",14),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(1),e.Q6J("src",null==i?null:i.imagen,e.LSH)}}function te(o,s){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const i=e.oxw();e.xp6(1),e.lnq("Turno para el paciente ",null==i.paciente?null:i.paciente.nombre," ",null==i.paciente?null:i.paciente.apellido," con DNI: ",null==i.paciente?null:i.paciente.dni,"")}}function oe(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"span",17),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw(2).cambioEspecialidad(a)}),e._UZ(1,"img",14),e.TgZ(2,"p"),e._uU(3),e.qZA(),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(1),e.Q6J("src",null==i?null:i.imagen,e.LSH),e.xp6(2),e.Oqu(i.especialidad)}}function ne(o,s){if(1&o&&(e.TgZ(0,"div",15),e.YNc(1,oe,4,2,"span",16),e.qZA()),2&o){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",i.array)}}function ae(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"div",24),e.TgZ(1,"span",25),e.NdJ("click",function(){const a=e.CHM(i).$implicit,l=e.oxw().$implicit;return e.oxw(2).seleccionarHora(l.dia,a)}),e._uU(2),e.qZA(),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(2),e.Oqu(i)}}function se(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"div",20),e.TgZ(1,"div",21),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw(2).seleccionarFecha(a)}),e.TgZ(2,"span",22),e._uU(3),e.qZA(),e.TgZ(4,"div",18),e.YNc(5,ae,3,1,"div",23),e.qZA(),e.qZA(),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(3),e.hij(" ",i.dia," "),e.xp6(2),e.Q6J("ngForOf",null==i?null:i.turnosDelDia)}}function le(o,s){if(1&o&&(e.TgZ(0,"div",18),e.YNc(1,se,6,2,"div",19),e.qZA()),2&o){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",i.fechasEspecialistaActual)}}function re(o,s){if(1&o&&(e.TgZ(0,"div",26),e.TgZ(1,"div",27),e._uU(2),e.qZA(),e.qZA()),2&o){const i=e.oxw();e.xp6(2),e.Oqu(i.mensaje)}}function ce(o,s){1&o&&e._UZ(0,"app-spinner")}function de(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"span",14),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw(3).seleccionarEspecialista(a)}),e._UZ(1,"img",15),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(1),e.Q6J("src",null==i?null:i.imagen,e.LSH)}}function pe(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"span",16),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw(3).seleccionarEspecialidad(a)}),e._UZ(1,"img",15),e.TgZ(2,"p"),e._uU(3),e.qZA(),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(1),e.Q6J("src",null==i?null:i.imagen,e.LSH),e.xp6(2),e.Oqu(i.especialidad)}}function me(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"div",17),e.TgZ(1,"div",18),e.TgZ(2,"h6"),e._uU(3),e.qZA(),e.TgZ(4,"h6"),e._uU(5),e.qZA(),e.TgZ(6,"h6"),e._uU(7),e.qZA(),e.TgZ(8,"h6",19),e._uU(9),e.qZA(),e.TgZ(10,"h6",19),e._uU(11),e.qZA(),e.TgZ(12,"h6"),e._uU(13),e.ALo(14,"uppercase"),e.qZA(),e.qZA(),e.TgZ(15,"div",20),e.TgZ(16,"div",21),e.TgZ(17,"i",22),e.NdJ("click",function(){const a=e.CHM(i).$implicit;return e.oxw(3).cancelarTurno(a)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const i=s.$implicit;e.xp6(3),e.Oqu(null==i?null:i.fecha),e.xp6(2),e.Oqu(null==i?null:i.hora),e.xp6(2),e.Oqu(null==i?null:i.especialidad),e.xp6(2),e.lnq("",null==i||null==i.especialistaCompleto?null:i.especialistaCompleto.nombre," ",null==i||null==i.especialistaCompleto?null:i.especialistaCompleto.apellido," - ",null==i.especialistaCompleto?null:i.especialistaCompleto.dni,""),e.xp6(2),e.lnq("",null==i||null==i.pacienteCompleto?null:i.pacienteCompleto.nombre," ",null==i||null==i.pacienteCompleto?null:i.pacienteCompleto.apellido," - ",null==i||null==i.pacienteCompleto?null:i.pacienteCompleto.dni,""),e.xp6(2),e.Oqu(e.lcZ(14,10,null==i?null:i.estado))}}function _e(o,s){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"span",23),e._uU(2),e.qZA(),e.qZA()),2&o){const i=e.oxw(3);e.xp6(2),e.Oqu(i.mensaje)}}function fe(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"div",4),e.TgZ(1,"h2",5),e._uU(2,"Listado de turnos"),e.qZA(),e.TgZ(3,"i",6),e.NdJ("click",function(){return e.CHM(i),e.oxw(2).limpiarFiltros()}),e._uU(4,"Limpiar filtros"),e.qZA(),e.TgZ(5,"div",7),e.YNc(6,de,2,1,"span",8),e.qZA(),e.TgZ(7,"div",9),e.YNc(8,pe,4,2,"span",10),e.qZA(),e.TgZ(9,"div",11),e.YNc(10,me,18,12,"div",12),e.qZA(),e.YNc(11,_e,3,1,"div",13),e.qZA()}if(2&o){const i=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",i.especialistas),e.xp6(2),e.Q6J("ngForOf",i.array),e.xp6(2),e.Q6J("ngForOf",i.turnosMostrar),e.xp6(1),e.Q6J("ngIf",""!==i.mensaje)}}function ge(o,s){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,fe,12,4,"div",3),e.qZA()),2&o){const i=e.oxw(),t=e.MAs(3);e.xp6(1),e.Q6J("ngIf",i.turnos[0].especialistaCompleto)("ngIfElse",t)}}function he(o,s){1&o&&e._UZ(0,"app-spinner")}const ve=[{path:"mis-turnos/especialista",component:D,canActivate:[y]},{path:"mis-turnos/paciente",component:X,canActivate:[M]},{path:"solicitar-turno",component:(()=>{class o{constructor(i,t){this.firestore=i,this.datePipe=t,this.especialidadActual="",this.paciente=null,this.array=[],this.turnos=[],this.turnosM=[],this.turnosT=[],this.fechas=[],this.fechasEspecialistaActual=[],this.fecha="",this.hora="",this.mensaje="",this.recibido=!1,this.shortcutHorario=!1,this.turnosM=["08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30"],this.turnosT=["13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30"],this.turnos=["08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30"],this.getEspecialidades(),this.getEspecialistas(),this.getPacientes(),this.obtenerProximosDias(new Date,15)}ngOnInit(){}cambiarEspecialista(i){var t;if(this.shortcutHorario=!1,"paciente"===(null===(t=this.firestore.usuarioActual)||void 0===t?void 0:t.perfil)&&!this.paciente&&(this.paciente=this.firestore.usuarioActual),this.especialista!==i){if(this.mensaje="",this.especialista=i,this.fechasEspecialistaActual=[],1===i.especialidad.length)return this.shortcutHorario=!0,this.fechaSeleccionada=null,this.especialidadActual=this.especialista.especialidad[0],this.cargarHorarios(),!0;this.array=[];for(let n of this.especialidades)for(let a of this.especialista.especialidad)n.especialidad===a&&this.array.push(n);console.log(this.array)}return!0}seleccionarFecha(i){this.fechaSeleccionada=i}cargarHorarios(){var i,t,n,a;if(null===(i=this.especialista)||void 0===i?void 0:i.horarios)for(let l of this.fechas)for(let r of null===(t=this.especialista)||void 0===t?void 0:t.horarios){let u;if(l.getDay()===r.dia){if(u=6!==l.getDay()?"T-M"===r.turno?{dia:this.datePipe.transform(l,"dd/MM/yyyy"),turnosDelDia:this.turnos.map(c=>c)}:"M"===r.turno?{dia:this.datePipe.transform(l,"dd/MM/yyyy"),turnosDelDia:this.turnosM.map(c=>c)}:{dia:this.datePipe.transform(l,"dd/MM/yyyy"),turnosDelDia:this.turnosT.map(c=>c)}:{dia:this.datePipe.transform(l,"dd/MM/yyyy"),turnosDelDia:this.turnosM.map((c,_)=>{if(_<13)return c})},null===(a=null===(n=this.especialista)||void 0===n?void 0:n.turno)||void 0===a?void 0:a.length)for(let c of this.especialista.turno)if(c.fecha===u.dia){let _=u.turnosDelDia.indexOf(c.hora);-1!==_&&u.turnosDelDia.splice(_,1)}this.fechasEspecialistaActual.push(u)}}else this.mensaje="El especialista no tiene disponibilidad horaria"}seleccionarHora(i,t){this.fechaSeleccionada={dia:i,hora:t};for(let n of this.fechasEspecialistaActual)if(n.dia===i)for(let a of n.turnosDelDia)if(a===t){console.log(n.dia),console.log(i),n.turnosDelDia.splice(n.turnosDelDia.indexOf(t),1);break}this.solicitarTurno()}getEspecialidades(){this.firestore.especialidadesObs.subscribe(i=>{this.especialidades=i})}getEspecialistas(){this.firestore.especialistasObs.subscribe(i=>{this.especialistas=i;for(let t of this.especialistas)!1===t.habilitado&&this.especialistas.splice(this.especialistas.indexOf(t),1)})}getPacientes(){this.firestore.pacientesObs.subscribe(i=>{this.pacientes=i})}cambioEspecialidad(i){this.hora="",this.fechaSeleccionada=null,this.especialidadActual=i.especialidad,this.fechasEspecialistaActual=[],this.cargarHorarios()}solicitarTurno(){var i,t,n;let a={fecha:this.fechaSeleccionada.dia,hora:this.fechaSeleccionada.hora,dniPaciente:this.paciente.dni,especialidad:this.especialidadActual};(null===(i=this.especialista)||void 0===i?void 0:i.turno)||(this.especialista.turno=[]),(null===(t=this.paciente)||void 0===t?void 0:t.turno)||(this.paciente.turno=[]),this.especialista.turno.push(a);let l={especialidad:this.especialidadActual,especialista:null===(n=this.especialista)||void 0===n?void 0:n.dni,fecha:this.fechaSeleccionada.dia,hora:this.fechaSeleccionada.hora};this.paciente.turno.push(l),this.firestore.addTurnoPaciente(this.paciente.turno,this.paciente.id),this.firestore.addTurnoEspecialista(this.especialista),l.especialista=this.especialista.dni,l.paciente=this.paciente.dni,l.estado="pendiente",this.firestore.addTurno(l),p().fire({text:`Turno sacado con exito el dia: ${this.fechaSeleccionada.dia} a la hora: ${this.fechaSeleccionada.hora}`,timer:2500,timerProgressBar:!0,icon:"success",toast:!0,position:"bottom"})}obtenerProximosDias(i,t){for(let n=0;n<t;n++)i.setDate(i.getDate()+1),this.fechas.push(new Date(i))}recibirPaciente(i){this.recibido=!0,this.paciente=i}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(Z.C),e.Y36(m.uU))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-solicitar-turno"]],decls:16,vars:7,consts:[[1,"container"],[4,"ngIf"],[1,"col-12","col-md-8"],["class","badge rounded-pill bg-dark text-light m-1 mt-2 p-2 noselect",3,"click",4,"ngFor","ngForOf"],[1,"col-12","col-sm-6","text-light"],["class","col-12 col-md-6 d-flex flex-wrap text-light",4,"ngIf"],[1,"badge","rounded-pill","bg-warning","text-dark","m-1","mt-2","p-2","noselect"],[1,"col-12","mt-1"],["class","row",4,"ngIf"],["class","col-4",4,"ngIf"],["spinner",""],[3,"pacientes","enviar",4,"ngIf","ngIfElse"],[3,"pacientes","enviar"],[1,"badge","rounded-pill","bg-dark","text-light","m-1","mt-2","p-2","noselect",3,"click"],["alt","","width","80px","height","80px",2,"border-radius","50%",3,"src"],[1,"col-12","col-md-6","d-flex","flex-wrap","text-light"],["class","d-inline-flex flex-column me-2",3,"click",4,"ngFor","ngForOf"],[1,"d-inline-flex","flex-column","me-2",3,"click"],[1,"row"],["class","col-12 col-md-4 border border-warning",4,"ngFor","ngForOf"],[1,"col-12","col-md-4","border","border-warning"],[3,"click"],[1,"badge","rounded-pill","bg-warning","text-dark","text-light","mb-1","mt-1","p-2","noselect"],["class","col-4 col-md-3",4,"ngFor","ngForOf"],[1,"col-4","col-md-3"],[1,"badge","rounded-pill","bg-dark","text-light","p-2","noselect","mt-2","mb-1",3,"click"],[1,"col-4"],[1,"text-danger"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0),e.YNc(1,ee,2,2,"div",1),e.TgZ(2,"div"),e.TgZ(3,"form"),e.TgZ(4,"div",2),e.YNc(5,ie,2,1,"span",3),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,te,2,3,"span",1),e.qZA(),e.YNc(8,ne,2,1,"div",5),e.TgZ(9,"span",6),e._uU(10),e.qZA(),e.TgZ(11,"div",7),e.YNc(12,le,2,1,"div",8),e.YNc(13,re,3,1,"div",9),e.qZA(),e.qZA(),e.qZA(),e.YNc(14,ce,1,0,"ng-template",null,10,e.W1O),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngIf","admin"===(null==t.firestore||null==t.firestore.usuarioActual?null:t.firestore.usuarioActual.perfil)),e.xp6(4),e.Q6J("ngForOf",t.especialistas),e.xp6(2),e.Q6J("ngIf","admin"===(null==t.firestore.usuarioActual?null:t.firestore.usuarioActual.perfil)),e.xp6(1),e.Q6J("ngIf",!t.shortcutHorario),e.xp6(2),e.Oqu(t.especialidadActual),e.xp6(2),e.Q6J("ngIf",""===t.mensaje&&t.especialista),e.xp6(1),e.Q6J("ngIf",""!==t.mensaje))},directives:[m.O5,g._Y,g.JL,g.F,m.sg,W._,T.O],styles:[""]}),o})(),canActivate:[q]},{path:"",component:(()=>{class o{constructor(i){var t=this;this.firestore=i,this.array=[],this.mensaje="",this.firestore.especialidadesObs.subscribe(n=>{this.especialidades=n,this.firestore.turnosObs.subscribe(function(){var a=(0,f.Z)(function*(l){let r;t.turnos=l;for(let u of t.turnos)for(let c of t.especialidades)c.especialidad===u.especialidad&&(r=t.array.indexOf(c),-1===r&&t.array.push(c));yield t.getPacientes(),yield t.getEspecialistas(),t.turnosMostrar=t.turnos});return function(l){return a.apply(this,arguments)}}())})}ngOnInit(){}getPacientes(){var i=this;return(0,f.Z)(function*(){for(let t of i.turnos)t.pacienteCompleto=yield i.firestore.getPaciente(t.paciente)})()}getEspecialistas(){var i=this;return(0,f.Z)(function*(){let n;i.especialistas=[];for(let a of i.turnos)n=yield i.firestore.getEspecialista(a.especialista),a.especialistaCompleto=n,i.especialistas.push(n);i.especialistas=i.eliminarObjetosDuplicados(i.especialistas,"dni")})()}limpiarFiltros(){this.mensaje="",this.turnosMostrar=this.turnos}seleccionarEspecialista(i){this.turnosMostrar=[],this.especialista=i;for(let t of this.turnos)t.especialista===i.dni&&this.turnosMostrar.push(t);0===this.turnosMostrar.length&&(this.mensaje="No hay turnos con el especialista seleccionado")}seleccionarEspecialidad(i){this.mensaje="",this.turnosMostrar=[],this.especialidad=i.especialidad;for(let t of this.turnos)t.especialidad===i.especialidad&&this.turnosMostrar.push(t);0===this.turnosMostrar.length&&(this.mensaje="No hay turnos con la especialidad seleccionada")}eliminarObjetosDuplicados(i,t){var n=[],a={};for(let l in i)a[i[l][t]]=i[l];for(let l in a)n.push(a[l]);return n}cancelarTurno(i){var t=this;return(0,f.Z)(function*(){let n=0;const{value:a}=yield p().fire({title:"Cancelaci\xf3n de turno",input:"text",inputLabel:"Motivo de cancelaci\xf3n",inputValue:"",showCancelButton:!0,inputValidator:l=>l?"":"Debe especificar el motivo de la cancelaci\xf3n",inputAttributes:{required:"true",autocomplete:"off"}});if(a){i.estado="cancelado",i.razon=a,t.firestore.modificarEstadoTurno(i);for(let[l,r]of i.pacienteCompleto.turno.entries())if(i.fecha===r.fecha&&i.hora===r.hora){n=l;break}i.pacienteCompleto.turno.splice(n,1),t.firestore.finalizarTurnoPaciente(i.pacienteCompleto);for(let[l,r]of i.especialistaCompleto.turno.entries())if(i.fecha===r.fecha&&i.hora===r.hora){n=l;break}i.especialistaCompleto.turno.splice(n,1),t.firestore.finalizarTurnoEspecialista(i.especialistaCompleto)}else p().fire({text:"El turno no ha podido ser cancelado. Motivo: Debe especificar una razon",timer:2500,timerProgressBar:!0,icon:"error",position:"bottom",toast:!0})})()}verComentario(i){(null==i?void 0:i.comentario)?p().fire({title:"Comentario sobre el turno",text:i.comentario}):(null==i?void 0:i.razon)&&p().fire({title:"Motivo de cancelacion/rechazo del turno",text:i.razon})}}return o.\u0275fac=function(i){return new(i||o)(e.Y36(Z.C))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-turnos"]],decls:4,vars:2,consts:[[1,"container"],[4,"ngIf","ngIfElse"],["spinner",""],["class","text-light",4,"ngIf","ngIfElse"],[1,"text-light"],[1,"text-center","text-light"],[1,"bi","bi-funnel-fill","text-info","noselect",3,"click"],[1,"col-12","col-sm-6"],["class","badge rounded-pill bg-dark text-light m-1 mt-2 p-2 noselect",3,"click",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","d-flex","text-light"],["class","d-inline-flex flex-column me-2",3,"click",4,"ngFor","ngForOf"],[1,"row","justify-content-around",2,"column-gap","40px","row-gap","15px"],["class","col-12 col-md-3 row rounded text-white","style","background-color: rgba(0,0,0,.5);",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"badge","rounded-pill","bg-dark","text-light","m-1","mt-2","p-2","noselect",3,"click"],["alt","","width","80px","height","80px",2,"border-radius","50%",3,"src"],[1,"d-inline-flex","flex-column","me-2",3,"click"],[1,"col-12","col-md-3","row","rounded","text-white",2,"background-color","rgba(0,0,0,.5)"],[1,"col-6"],[1,"text-break"],[1,"col-6","d-flex","h-100","justify-content-end"],[1,"d-flex","flex-column"],["title","Cancelar turno",1,"bi","bi-x-square-fill",3,"click"],[1,"text-danger"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,ge,2,2,"div",1),e.YNc(2,he,1,0,"ng-template",null,2,e.W1O),e.qZA()),2&i){const n=e.MAs(3);e.xp6(1),e.Q6J("ngIf",t.turnosMostrar.length)("ngIfElse",n)}},directives:[m.O5,m.sg,T.O],pipes:[m.gd],styles:[""]}),o})(),canActivate:[E.u]}];let xe=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[v.Bz.forChild(ve)],v.Bz]}),o})();var Ze=d(2271),Te=d(9433);let be=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[m.uU],imports:[[m.ez,xe,g.u5,g.UX,Ze.m,Te.UsuariosModule]]}),o})()}}]);